% Trade‑book Pandoc template (Four‑Hour‑Workweek vibe)
% Uses: scrbook, titlesec, tcolorbox, fontspec, microtype
\documentclass[11pt,oneside]{scrbook}

% --- Page geometry: 6×9 in trade size ---
\usepackage[paperwidth=6in,paperheight=9in,top=0.9in,bottom=1in,inner=0.9in,outer=0.9in]{geometry}

% --- Fonts (macOS system fonts) ---
\usepackage{fontspec}
\setmainfont{Times New Roman} % bookish serif
\setsansfont{Helvetica}       % clean sans for headings  
\setmonofont{Menlo}           % monospace

% --- Microtypography ---
\usepackage[final]{microtype}
\microtypesetup{tracking=true,protrusion=true}

% --- Colors, links ---
\usepackage[dvipsnames]{xcolor}
\definecolor{Accent}{HTML}{0B6E99}      % teal-ish accent
\definecolor{Ink}{HTML}{222222}
\definecolor{GrayBg}{HTML}{F7F7F7}
\usepackage[unicode]{hyperref}
\hypersetup{colorlinks=true, linkcolor=Accent, urlcolor=Accent, citecolor=Accent}
\urlstyle{same} % URLs match body font

% --- Headers/footers (KOMA) ---
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[C]{\thepage}
\fancyhead[L]{\sffamily\footnotesize\leftmark}
\renewcommand{\headrulewidth}{0pt}
% Cleaner running heads
\renewcommand*{\chaptermarkformat}{} % drop "Chapter N."

% --- Paragraph look (Four Hour Workweek style) ---
\setlength{\parindent}{0pt}
\setlength{\parskip}{12pt}
\linespread{1.15}

% --- Widow/orphan control ---
\clubpenalty=10000
\widowpenalty=10000
\displaywidowpenalty=10000

% --- Chapter & section styling (Four Hour Workweek style) ---
\usepackage{titlesec}
% Number chapters only; do not number sections/subsections
\setcounter{secnumdepth}{0}

% Clean chapter style without rules
\titleformat{\chapter}[display]
  {\sffamily\bfseries\Huge\color{Ink}}
  {\Large\color{black!60}\chaptertitlename\,\thechapter}
  {20pt}
  {}
\titlespacing*{\chapter}{0pt}{40pt}{30pt}

% Clean section and subsection styles
\titleformat{\section}{\sffamily\bfseries\LARGE\color{Ink}}{\thesection}{1em}{}
\titlespacing*{\section}{0pt}{24pt}{12pt}
\titleformat{\subsection}{\sffamily\bfseries\Large\color{Ink}}{\thesubsection}{1em}{}
\titlespacing*{\subsection}{0pt}{18pt}{8pt}

% --- Callouts & pull‑quotes (Four Hour Workweek style) ---
\usepackage[most]{tcolorbox}
\tcbset{sharp corners, boxsep=0pt, left=0pt, right=0pt, top=0pt, bottom=0pt}

% Note boxes - clean with left border
\newtcolorbox{notebox}{
  breakable,
  enhanced,
  colback=white,
  colframe=white,
  borderline west={4pt}{0pt}{Accent},
  left=12pt,
  right=12pt,
  top=8pt,
  bottom=8pt,
  fontupper=\small
}

% Tip boxes - similar to notes but green accent
\newtcolorbox{tipbox}{
  breakable,
  enhanced,
  colback=white,
  colframe=white,
  borderline west={4pt}{0pt}{ForestGreen!80!black},
  left=12pt,
  right=12pt,
  top=8pt,
  bottom=8pt,
  fontupper=\small
}

% Pull quotes - elegant, centered, larger text
\newtcolorbox{pullquote}{
  breakable,
  enhanced,
  colback=GrayBg,
  colframe=GrayBg,
  left=20pt,
  right=20pt,
  top=15pt,
  bottom=15pt,
  fontupper=\large\itshape\centering,
  before upper={\vspace{5pt}},
  after upper={\vspace{5pt}}
}

% --- Tables ---
\usepackage{longtable}
\usepackage{booktabs}

% --- Figure & table captions (clean) ---
\usepackage{caption}
\captionsetup{labelfont={sf,bf,small}, textfont={sf,small}, justification=raggedright, singlelinecheck=false}

% --- Code blocks ---
\usepackage{fancyvrb}
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}

% --- Pandoc compatibility ---
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\usepackage{amssymb}

% --- Pandoc variables ---
$if(title)$
  \title{\sffamily\bfseries\Huge $title$}
$endif$
$if(subtitle)$
  \subtitle{\sffamily\Large\color{black!60} $subtitle$}
$endif$
$if(author)$
  \author{\sffamily\large $for(author)$$author$$sep$ \and $endfor$}
$endif$
$if(date)$
  \date{\sffamily $date$}
$else$
  \date{}
$endif$

\begin{document}
$if(title)$
  \maketitle
$endif$
$if(toc)$
  \tableofcontents
  \cleardoublepage
$endif$

$body$

\backmatter
$if(colophon)$
  \chapter*{Colophon}
  $colophon$
$endif$
\end{document}